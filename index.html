<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>WorksTime - Hours Tracker (Green)</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{
  --accent:#00ff9f;
  --accent-soft:#16c57c;
  --bg1:#00140d;
  --bg2:#00221a;
  --panel:rgba(0,60,42,.35);
  --panel-line:rgba(0,255,159,.28);
  --text:#e8fff4;
  --text-dim:#7affc9;
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{max-width:100%;overflow-x:hidden}
body{
  font-family:'Share Tech Mono','Segoe UI',sans-serif;
  background:radial-gradient(circle at 35% 25%,#014d32 0%,#001d15 55%,#000c08 100%);
  color:var(--text);
  min-height:100vh;
  padding:16px 14px 60px;
  direction:rtl;
  -webkit-font-smoothing:antialiased;
}
body.ltr{direction:ltr}
body::before,body::after{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:-1;
}
body::before{
  background:
    repeating-linear-gradient(90deg,rgba(0,255,159,.055) 0 2px,transparent 2px 4px),
    repeating-linear-gradient(0deg,rgba(0,255,159,.045) 0 2px,transparent 2px 4px);
  opacity:.22;
  animation:bgFloat 18s linear infinite;
}
body::after{
  background:linear-gradient(180deg,transparent 0%,rgba(0,255,159,.09) 50%,transparent 100%);
  animation:scan 7s linear infinite;
  opacity:.35;
}
@keyframes bgFloat{
  0%,100%{transform:translate(0,0)}
  50%{transform:translate(-12px,18px)}
}
@keyframes scan{
  0%{transform:translateY(-100%)}
  100%{transform:translateY(100%)}
}
.container{
  width:100%;
  max-width:480px;
  margin:0 auto;
  background:linear-gradient(150deg,rgba(0,65,44,.55),rgba(0,35,25,.55));
  border:1px solid var(--panel-line);
  border-radius:20px;
  padding:26px 22px 34px;
  backdrop-filter:blur(12px) saturate(150%);
  -webkit-backdrop-filter:blur(12px) saturate(150%);
  position:relative;
  box-shadow:0 12px 38px -14px rgba(0,0,0,.85),0 0 0 1px rgba(0,255,159,.08);
}
.container::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  background:
    linear-gradient(120deg,rgba(0,255,159,.4),rgba(0,255,159,0) 40%,rgba(0,255,159,.3) 65%,rgba(0,255,159,0) 90%);
  mix-blend-mode:overlay;
  opacity:.55;
}
.header{text-align:center;margin-bottom:24px}
.header h1{
  font-size:2.2rem;
  letter-spacing:2px;
  color:var(--accent);
  text-shadow:0 0 12px rgba(0,255,159,.7),0 0 28px rgba(0,255,159,.25);
  position:relative;
  animation:pulse 3.8s ease-in-out infinite;
}
.header h1::after{
  content:"_";
  margin-right:6px;
  animation:blink 1.05s steps(2,start) infinite;
  color:var(--accent-soft);
}
.ltr .header h1::after{margin-left:6px;margin-right:0}
@keyframes blink{50%{opacity:0}}
@keyframes pulse{
  0%,100%{text-shadow:0 0 10px rgba(0,255,159,.7),0 0 28px rgba(0,255,159,.25)}
  50%{text-shadow:0 0 18px rgba(0,255,159,.9),0 0 40px rgba(0,255,159,.4)}
}
.controls-row{
  display:flex;
  flex-wrap:wrap;
  gap:14px;
  justify-content:space-between;
  margin-bottom:18px;
}
.language-toggle{display:flex;gap:6px}
.lang-btn{
  background:rgba(0,255,159,.08);
  border:1px solid rgba(0,255,159,.35);
  color:var(--text-dim);
  padding:8px 12px;
  font-size:12px;
  letter-spacing:1px;
  border-radius:8px;
  cursor:pointer;
  transition:.3s;
  text-transform:uppercase;
}
.lang-btn.active,
.lang-btn:hover{
  color:var(--accent);
  border-color:var(--accent);
  box-shadow:0 0 8px rgba(0,255,159,.45);
}
.shift-group{flex:1;min-width:160px}
.shift-label{
  font-size:11px;
  color:var(--accent);
  letter-spacing:1px;
  margin-bottom:4px;
  text-transform:uppercase;
}
.shift-select{position:relative}
.shift-select select{
  width:100%;
  padding:12px 14px;
  border:1px solid rgba(0,255,159,.35);
  background:rgba(0,40,28,.6);
  color:var(--accent);
  font-size:14px;
  border-radius:10px;
  cursor:pointer;
  appearance:none;
  direction:rtl;
  font-weight:600;
  transition:.3s;
}
body.ltr .shift-select select{direction:ltr}
.shift-select::after{
  content:"âŒ„";
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  left:14px;
  color:var(--accent);
  pointer-events:none;
  font-size:13px;
  text-shadow:0 0 6px rgba(0,255,159,.6);
}
body.ltr .shift-select::after{right:14px;left:auto}
.shift-select select:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(0,255,159,.25),0 0 14px -2px rgba(0,255,159,.55);
}
.work-schedule{
  background:rgba(0,255,159,.07);
  border:1px solid rgba(0,255,159,.25);
  border-radius:16px;
  padding:18px 16px 20px;
  text-align:center;
  position:relative;
  margin-bottom:26px;
  overflow:hidden;
}
.work-schedule h3{
  color:var(--accent);
  font-size:1rem;
  margin-bottom:8px;
  letter-spacing:.5px;
}
.schedule-time{
  font-size:.95rem;
  line-height:1.45;
  color:var(--text);
}
.schedule-time span.key{color:var(--accent)}
.shift-info{
  display:flex;
  justify-content:space-between;
  margin-top:10px;
  font-size:.75rem;
  color:var(--text-dim);
  font-weight:600;
}
.shift-info span.value{color:var(--accent)}
.input-group{margin-bottom:22px}
.input-group label{
  display:block;
  margin-bottom:8px;
  color:var(--accent);
  font-size:.85rem;
  letter-spacing:.5px;
}
input[type=text]{
  width:100%;
  padding:13px 14px;
  border:1px solid rgba(0,255,159,.35);
  border-radius:10px;
  background:rgba(0,40,28,.55);
  color:var(--text);
  font-size:14px;
  transition:.3s;
}
input[type=text]:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(0,255,159,.2),0 0 14px -2px rgba(0,255,159,.5);
}
.time-inputs{
  display:flex;
  gap:10px;
  direction:ltr;
  align-items:center;
}
.time-select{position:relative}
.time-select select{
  width:80px;
  padding:12px 10px;
  border:1px solid rgba(0,255,159,.35);
  background:rgba(0,40,28,.55);
  color:var(--accent);
  font-weight:600;
  border-radius:10px;
  text-align:center;
  cursor:pointer;
  appearance:none;
  direction:ltr;
  transition:.3s;
}
.time-select::after{
  content:"âŒ„";
  position:absolute;
  right:10px;
  top:50%;
  transform:translateY(-50%);
  font-size:11px;
  color:var(--accent);
  pointer-events:none;
}
.time-select select:focus{
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(0,255,159,.22),0 0 12px -2px rgba(0,255,159,.5);
}
.time-separator{
  font-size:22px;
  font-weight:700;
  color:var(--accent);
  text-shadow:0 0 6px rgba(0,255,159,.4);
}
.calculate-btn{
  width:100%;
  padding:16px 18px;
  background:linear-gradient(95deg,#00ff9f,#00c676 60%,#009f5d);
  border:none;
  border-radius:14px;
  color:#053626;
  font-size:16px;
  font-weight:700;
  letter-spacing:1px;
  cursor:pointer;
  transition:.35s;
  margin:4px 0 24px;
}
.calculate-btn:hover{
  transform:translateY(-3px);
  box-shadow:0 10px 28px -8px rgba(0,255,159,.55),0 0 0 2px rgba(0,255,159,.35);
}
.calculate-btn:active{
  transform:translateY(0);
  box-shadow:0 6px 20px -10px rgba(0,255,159,.4);
}
.results{
  display:none;
  background:rgba(0,255,159,.07);
  border:1px solid rgba(0,255,159,.28);
  border-radius:16px;
  padding:20px 18px 24px;
  position:relative;
}
.results.show{display:block;animation:fadeIn .55s ease}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(18px);filter:blur(3px)}
  to{opacity:1;transform:translateY(0);filter:blur(0)}
}
.result-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:8px 10px;
  margin-bottom:10px;
  background:rgba(0,255,159,.05);
  border:1px solid rgba(0,255,159,.18);
  border-radius:10px;
  font-size:.9rem;
}
.result-label{color:var(--text-dim);font-weight:600}
.result-value{font-weight:700;color:var(--text);direction:ltr}
.result-value.remaining-hours{
  color:var(--accent);
  font-size:1.25rem;
  text-shadow:0 0 12px rgba(0,255,159,.65);
}
.result-value.leave-time{
  color:var(--accent-soft);
  font-size:1.15rem;
  text-shadow:0 0 10px rgba(0,255,159,.45);
}
.action-buttons{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  margin-top:18px;
}
@media (max-width:420px){
  .action-buttons{grid-template-columns:1fr}
  .shift-select select,#shiftSelect{font-size:13px}
  .container{padding:24px 18px 30px}
}
.action-btn{
  position:relative;
  background:rgba(0,255,159,.1);
  border:1px solid rgba(0,255,159,.35);
  border-radius:12px;
  padding:12px 14px;
  font-size:13px;
  font-weight:600;
  color:var(--accent);
  cursor:pointer;
  letter-spacing:.5px;
  transition:.35s;
  text-align:center;
}
.action-btn:hover{
  background:linear-gradient(135deg,#00ff9f,#009e62);
  color:#053626;
  box-shadow:0 0 0 2px rgba(0,255,159,.25),0 8px 24px -10px rgba(0,255,159,.55);
  transform:translateY(-2px);
}
.action-btn:active{transform:translateY(0)}
.notification{
  position:fixed;
  bottom:16px;
  inset-inline:0;
  width:fit-content;
  max-width:90%;
  margin:0 auto;
  background:#003322;
  border:1px solid rgba(0,255,159,.4);
  color:var(--accent);
  padding:14px 20px;
  border-radius:14px;
  font-size:.8rem;
  letter-spacing:.5px;
  font-weight:600;
  opacity:0;
  transform:translateY(30px);
  transition:.45s;
  z-index:1000;
  box-shadow:0 0 0 2px rgba(0,255,159,.25),0 12px 28px -10px rgba(0,255,159,.55);
}
.notification.show{opacity:1;transform:translateY(0)}
.hidden-canvas{position:absolute;left:-9999px;top:-9999px}
</style>
</head>
<body>
  <div class="container">
    <div class="controls-row">
      <div class="language-toggle">
        <button class="lang-btn" onclick="setLanguage(this,'en')">English</button>
        <button class="lang-btn active" onclick="setLanguage(this,'ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
      </div>
      <div class="shift-group">
        <div class="shift-label" data-en="Work Shift" data-ar="Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ø¯ÙŠØ©">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ±Ø¯ÙŠØ©</div>
        <div class="shift-select">
          <select id="shiftSelect" onchange="setShift(this.value)">
            <option value="morning" data-en="ğŸŒ… Morning Shift" data-ar="ğŸŒ… Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©">ğŸŒ… Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©</option>
            <option value="morning2" data-en="ğŸˆ Morning Shift 2" data-ar="ğŸˆ Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© 2">ğŸˆ Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© 2</option>
            <option value="evening" data-en="ğŸŒ† Evening Shift" data-ar="ğŸŒ† Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©">ğŸŒ† Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©</option>
            <option value="evening2" data-en="ğŸ”§ Evening Shift 2" data-ar="ğŸ”§ Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ© 2">ğŸ”§ Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ© 2</option>
          </select>
        </div>
      </div>
    </div>

    <div class="header">
      <h1 data-en="â° WorksTime" data-ar="â° Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„">â° Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„</h1>
    </div>

    <div class="work-schedule">
      <h3 data-en="ğŸ“… Work Schedule" data-ar="ğŸ“… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„">ğŸ“… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„</h3>
      <div class="schedule-time" id="scheduleDisplay">
        <span class="key" data-en="Start:" data-ar="Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:">Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</span>
        <span id="startTime">7:15 AM</span> |
        <span class="key" data-en="End:" data-ar="Ø§Ù„Ù†Ù‡Ø§ÙŠØ©:">Ø§Ù„Ù†Ù‡Ø§ÙŠØ©:</span>
        <span id="endTime">3:15 PM</span><br>
        <span class="key" data-en="Daily Hours:" data-ar="Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©:">Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©:</span>
        <span id="dailyHours">8 hours</span>
      </div>
      <div class="shift-info">
        <span data-en="Monthly Total:" data-ar="Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø´Ù‡Ø±ÙŠ:">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø´Ù‡Ø±ÙŠ:</span>
        <span class="value">22 hours</span>
      </div>
    </div>

    <div class="input-group">
      <label for="employeeName" data-en="ğŸ‘¤ Employee Name (Optional)" data-ar="ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input type="text" id="employeeName" data-en-placeholder="Enter your name (optional)" data-ar-placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    </div>

    <div class="input-group">
      <label data-en="â±ï¸ Used Hours" data-ar="â±ï¸ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©">â±ï¸ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©</label>
      <div class="time-inputs">
        <div class="time-select">
          <select id="usedHours">
            <option value="0">0</option>
            <!-- 1..22 -->
            <script>
              // populate hours (keep inline so no extra script tag later)
              document.addEventListener('DOMContentLoaded',()=> {
                const sel=document.getElementById('usedHours');
                for(let i=1;i<=22;i++){const o=document.createElement('option');o.value=i;o.textContent=i;sel.appendChild(o);}
              });
            </script>
          </select>
        </div>
        <span class="time-separator">:</span>
        <div class="time-select">
          <select id="usedMinutes">
            <script>
              document.addEventListener('DOMContentLoaded',()=>{
                const mins=document.getElementById('usedMinutes');
                for(let i=0;i<60;i++){const o=document.createElement('option');o.value=i;o.textContent=i.toString().padStart(2,'0');mins.appendChild(o);}
              });
            </script>
          </select>
        </div>
      </div>
    </div>

    <button class="calculate-btn" onclick="calculateResults()" data-en="ğŸ§® Calculate Results" data-ar="ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬">ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>

    <div class="results" id="results">
      <div class="result-item">
        <span class="result-label" data-en="ğŸ¯ Remaining Hours:" data-ar="ğŸ¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:">ğŸ¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</span>
        <span class="result-value remaining-hours" id="remainingHours">-</span>
      </div>
      <div class="result-item">
        <span class="result-label" data-en="ğŸšª Can Leave At:" data-ar="ğŸšª ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© ÙÙŠ:">ğŸšª ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© ÙÙŠ:</span>
        <span class="result-value leave-time" id="leaveTime">-</span>
      </div>
      <div class="result-item">
        <span class="result-label" data-en="ğŸ“Š Hours Used:" data-ar="ğŸ“Š Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:">ğŸ“Š Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</span>
        <span class="result-value" id="hoursUsed">-</span>
      </div>

      <div class="action-buttons">
        <button class="action-btn" onclick="saveResults()" data-en="ğŸ’¾ Save" data-ar="ğŸ’¾ Ø­ÙØ¸">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="action-btn" onclick="shareWhatsApp()" data-en="ğŸ“± WhatsApp" data-ar="ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨">ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨</button>
        <button class="action-btn" onclick="saveAsImage()" data-en="ğŸ“¸ Save Image" data-ar="ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø©">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø©</button>
        <button class="action-btn" onclick="copyResults()" data-en="ğŸ“‹ Copy" data-ar="ğŸ“‹ Ù†Ø³Ø®">ğŸ“‹ Ù†Ø³Ø®</button>
      </div>
    </div>
  </div>

  <canvas id="canvas" class="hidden-canvas"></canvas>
  <div id="notification" class="notification"></div>

  <!-- Audio -->
  <audio id="clickSound" preload="auto"><source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfJ3+8=" type="audio/wav"></audio>
  <audio id="inputSound" preload="auto"><source src="data:audio/wav;base64,UklGRp4CAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YXoCAAC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4" type="audio/wav"></audio>
  <audio id="resultSound" preload="auto"><source src="data:audio/wav;base64,UklGRu4CAABXQVZFZm10IBAAAAABAAEAVFYAAKhWAQACABAAZGF0YcoCAADn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn" type="audio/wav"></audio>
  <audio id="dropdownSound" preload="auto"><source src="data:audio/wav;base64,UklGRtIBAABXQVZFZm10IBAAAAABAAIAESsAAFVWAAAEABAAZGF0YbIBAABBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFApGn+DyvmEYBjiQ2O/TgTAHKnfE9t2QQQsUXrTp66hUFAlF" type="audio/wav"></audio>

<script>
let currentLanguage='ar';
let currentShift='morning';
let currentResults={};

// Shift definitions (PLEASE confirm if any are different)
const shifts={
  morning:{startTime:'7:15 AM',endTime:'3:15 PM',dailyHours:8,startHour:7,startMinute:15,endHour:15,endMinute:15},
  morning2:{startTime:'7:00 AM',endTime:'1:00 PM',dailyHours:6,startHour:7,startMinute:0,endHour:13,endMinute:0},
  evening:{startTime:'1:00 PM',endTime:'7:00 PM',dailyHours:6,startHour:13,startMinute:0,endHour:19,endMinute:0},
  evening2:{startTime:'2:00 PM',endTime:'9:00 PM',dailyHours:7,startHour:14,startMinute:0,endHour:21,endMinute:0}
};

// Helper: play sound
function playSound(id){
  const a=document.getElementById(id);
  if(a){a.currentTime=0; a.play().catch(()=>{});}
}

// Language switch (NO reliance on implicit event)
function setLanguage(btn,lang){
  currentLanguage=lang;
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');

  if(lang==='ar'){
    document.body.classList.remove('ltr');
    document.documentElement.lang='ar';
    document.documentElement.dir='rtl';
  }else{
    document.body.classList.add('ltr');
    document.documentElement.lang='en';
    document.documentElement.dir='ltr';
  }

  // Replace text
  document.querySelectorAll('[data-'+lang+']').forEach(el=>{
    el.textContent=el.getAttribute('data-'+lang);
  });
  // Placeholders
  document.querySelectorAll('[data-'+lang+'-placeholder]').forEach(el=>{
    el.placeholder=el.getAttribute('data-'+lang+'-placeholder');
  });
  // Shift options text
  document.querySelectorAll('#shiftSelect option').forEach(o=>{
    const t=o.getAttribute('data-'+lang);
    if(t) o.textContent=t;
  });

  updateShiftDisplay();
  playSound('clickSound');
}

// Shift change
function setShift(value){
  if(!shifts[value]) return;
  currentShift=value;
  updateShiftDisplay();
  if(document.getElementById('results').classList.contains('show')){
    calculateResults();
  }
  playSound('dropdownSound');
}

// Update schedule UI
function updateShiftDisplay(){
  const s=shifts[currentShift];
  if(!s) return;
  document.getElementById('startTime').textContent=s.startTime;
  document.getElementById('endTime').textContent=s.endTime;
  // Force format with 'hours' (as you requested example "6 hours")
  const hStr = s.dailyHours + ' hours';
  document.getElementById('dailyHours').textContent = hStr;
}

// Calculation
function calculateResults(){
  const usedH=parseInt(document.getElementById('usedHours').value)||0;
  const usedM=parseInt(document.getElementById('usedMinutes').value)||0;
  const totalUsed=usedH*60+usedM;
  const totalWork=22*60;
  let remaining=totalWork-totalUsed;
  if(remaining<0) remaining=0;
  const remH=Math.floor(remaining/60);
  const remM=remaining%60;

  const s=shifts[currentShift];
  let leaveMinutes=(s.endHour*60+s.endMinute)-remaining;
  let leaveH=Math.floor(leaveMinutes/60);
  let leaveMin=leaveMinutes%60;
  if(leaveMin<0){leaveH--;leaveMin+=60;}

  // Clamp between start & end
  const startTotal=s.startHour*60+s.startMinute;
  const endTotal=s.endHour*60+s.endMinute;
  if(leaveMinutes<startTotal){leaveH=s.startHour;leaveMin=s.startMinute;}
  if(leaveMinutes>endTotal){leaveH=s.endHour;leaveMin=s.endMinute;}

  function formatTime(h,m){
    const period=h>=12?'PM':'AM';
    const display= h>12? h-12 : (h===0?12:h);
    return display+':'+m.toString().padStart(2,'0')+' '+period;
  }

  document.getElementById('remainingHours').textContent=remH+':'+remM.toString().padStart(2,'0');
  document.getElementById('leaveTime').textContent=formatTime(leaveH,leaveMin);
  document.getElementById('hoursUsed').textContent=usedH+':'+usedM.toString().padStart(2,'0');

  const shiftNames={
    morning: currentLanguage==='ar'?'Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ©':'Morning Shift',
    morning2: currentLanguage==='ar'?'Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„ØµØ¨Ø§Ø­ÙŠØ© 2':'Morning Shift 2',
    evening: currentLanguage==='ar'?'Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ©':'Evening Shift',
    evening2: currentLanguage==='ar'?'Ø§Ù„ÙˆØ±Ø¯ÙŠØ© Ø§Ù„Ù…Ø³Ø§Ø¦ÙŠØ© 2':'Evening Shift 2'
  };

  currentResults={
    name:document.getElementById('employeeName').value.trim(),
    shift:shiftNames[currentShift],
    usedHours:usedH+':'+usedM.toString().padStart(2,'0'),
    remainingHours:remH+':'+remM.toString().padStart(2,'0'),
    leaveTime:formatTime(leaveH,leaveMin)
  };

  document.getElementById('results').classList.add('show');
  playSound('resultSound');
}

// Save JSON
function saveResults(){
  if(!currentResults.shift) calculateResults();
  const data={timestamp:new Date().toISOString(),...currentResults};
  const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download='workstime-'+currentShift+'-'+new Date().toISOString().slice(0,10)+'.json';
  document.body.appendChild(a);a.click();document.body.removeChild(a);
  URL.revokeObjectURL(url);
  showNotification(currentLanguage==='ar'?'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­!':'Results saved successfully!');
}

// Share WhatsApp
function shareWhatsApp(){
  if(!currentResults.shift) calculateResults();
  const labels=currentLanguage==='ar' ? {
    title:'â° *ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„*',
    shift:'Ø§Ù„ÙˆØ±Ø¯ÙŠØ©',
    used:'Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©',
    remaining:'Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©',
    leave:'ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© ÙÙŠ',
    generated:'ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡'
  } : {
    title:'â° *WorksTime Report*',
    shift:'Shift',
    used:'Used Hours',
    remaining:'Remaining',
    leave:'Can Leave At',
    generated:'Generated'
  };
  const name=currentResults.name? (currentLanguage==='ar'? 'ğŸ‘¤ '+currentResults.name+'\n':'ğŸ‘¤ '+currentResults.name+'\n') : '';
  const msg=`${labels.title}\n\n${name}${labels.shift}: ${currentResults.shift}\n${labels.used}: ${currentResults.usedHours}\n${labels.remaining}: ${currentResults.remainingHours}\n${labels.leave}: ${currentResults.leaveTime}\n${labels.generated}: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`;
  window.open('https://wa.me/?text='+encodeURIComponent(msg),'_blank');
}

// Copy
function copyResults(){
  if(!currentResults.shift) calculateResults();
  const labels=currentLanguage==='ar' ? {
    title:'ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„',
    shift:'Ø§Ù„ÙˆØ±Ø¯ÙŠØ©',
    used:'Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©',
    remaining:'Ø§Ù„Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©',
    leave:'ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø© ÙÙŠ',
    generated:'ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡'
  } : {
    title:'WorksTime Report',
    shift:'Shift',
    used:'Used Hours',
    remaining:'Remaining Hours',
    leave:'Can Leave At',
    generated:'Generated'
  };
  const name=currentResults.name? (currentLanguage==='ar'? currentResults.name+'\n':currentResults.name+'\n') : '';
  const text=`${labels.title}\n\n${name}${labels.shift}: ${currentResults.shift}\n${labels.used}: ${currentResults.usedHours}\n${labels.remaining}: ${currentResults.remainingHours}\n${labels.leave}: ${currentResults.leaveTime}\n${labels.generated}: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`;
  navigator.clipboard.writeText(text)
    .then(()=>showNotification(currentLanguage==='ar'?'ØªÙ… Ø§Ù„Ù†Ø³Ø®!':'Copied!'))
    .catch(()=>showNotification(currentLanguage==='ar'?'ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®':'Copy failed'));
}

// Save image
function saveAsImage(){
  if(!currentResults.shift) calculateResults();
  const c=document.getElementById('canvas');
  const ctx=c.getContext('2d');
  c.width=640; c.height=420;
  const g=ctx.createLinearGradient(0,0,640,420);
  g.addColorStop(0,'#001f14'); g.addColorStop(1,'#000a06');
  ctx.fillStyle=g; ctx.fillRect(0,0,640,420);
  // grid
  ctx.strokeStyle='rgba(0,255,159,0.08)'; ctx.lineWidth=1;
  for(let x=0;x<=640;x+=32){ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,420);ctx.stroke();}
  for(let y=0;y<=420;y+=32){ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(640,y);ctx.stroke();}
  ctx.strokeStyle='rgba(0,255,159,.55)'; ctx.lineWidth=3; ctx.strokeRect(10,10,620,400);
  ctx.fillStyle='#00ff9f'; ctx.font='bold 30px Share Tech Mono'; ctx.textAlign='center';
  const title=currentLanguage==='ar'?'â° ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„':'â° WorksTime Report';
  ctx.shadowColor='rgba(0,255,159,.7)'; ctx.shadowBlur=16; ctx.fillText(title,320,60); ctx.shadowBlur=0;
  let y=110;
  if(currentResults.name){
    ctx.fillStyle='#7affc9'; ctx.font='20px Share Tech Mono';
    ctx.fillText('ğŸ‘¤ '+currentResults.name,320,y); y+=38;
  }
  ctx.textAlign=currentLanguage==='ar'?'right':'left';
  const x=currentLanguage==='ar'?590:50;
  ctx.fillStyle='#e8fff4'; ctx.font='18px Share Tech Mono';
  const lines=currentLanguage==='ar' ? [
    'Ø§Ù„ÙˆØ±Ø¯ÙŠØ©: '+currentResults.shift,
    'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©: '+currentResults.usedHours,
    'Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: '+currentResults.remainingHours,
    'Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©: '+currentResults.leaveTime
  ] : [
    'Shift: '+currentResults.shift,
    'Used: '+currentResults.usedHours,
    'Remain: '+currentResults.remainingHours,
    'Leave: '+currentResults.leaveTime
  ];
  lines.forEach((ln,i)=>ctx.fillText(ln,x,y+i*34));
  ctx.textAlign='center'; ctx.fillStyle='#00ff9f'; ctx.font='14px Share Tech Mono';
  const genLabel=currentLanguage==='ar'?'ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡':'Generated';
  ctx.fillText(`${genLabel}: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`,320,370);
  c.toBlob(b=>{
    const url=URL.createObjectURL(b);
    const a=document.createElement('a');
    a.href=url;
    a.download='workstime-'+currentShift+'-'+new Date().toISOString().slice(0,10)+'.png';
    document.body.appendChild(a);a.click();document.body.removeChild(a);
    URL.revokeObjectURL(url);
    showNotification(currentLanguage==='ar'?'ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©':'Image saved');
  });
}

// Notification
function showNotification(msg){
  const n=document.getElementById('notification');
  n.textContent=msg;
  n.classList.add('show');
  clearTimeout(showNotification._t);
  showNotification._t=setTimeout(()=>n.classList.remove('show'),3000);
}

// Auto recalc if user changes selects while results visible
['usedHours','usedMinutes'].forEach(id=>{
  document.addEventListener('change',e=>{
    if(e.target.id===id && document.getElementById('results').classList.contains('show')) calculateResults();
  });
});

// Enter key triggers calculate
document.addEventListener('keypress',e=>{
  if(e.key==='Enter') calculateResults();
});

// Initial display
document.addEventListener('DOMContentLoaded',()=>{
  updateShiftDisplay();
});
</script>
</body>
</html>